batch_size,128
dataset,ml1m
dropout_rate,0.2
gpu,0
item_hidden_units,50
k,10
l2_emb,0.0
lr,0.001
maxlen,200
num_blocks,2
num_epochs,2001
num_heads,1
print_freq,40
threshold_item,0.9
threshold_user,0.08
train_dir,default
user_hidden_units,50

There are 6040 users 3416 items

Average sequence length: 163.49850993377484

Maximum length of sequence: 2275

[0, 0.0, 0.04823983566434572, 0.10165562913907285, 0.04603304909675962, 0.09950331125827815],
Evaluating
epoch:40, time: 101.528896(s), valid (NDCG@10: 0.5753, HR@10: 0.8190), test (NDCG@10: 0.5460, HR@10: 0.7930)
[40, 101.52889561653137, 0.5752621708063331, 0.8190397350993377, 0.5460073038586633, 0.793046357615894],
Evaluating
epoch:80, time: 202.237908(s), valid (NDCG@10: 0.6033, HR@10: 0.8358), test (NDCG@10: 0.5817, HR@10: 0.8156)
[80, 202.2379081249237, 0.6033245466719991, 0.8357615894039735, 0.5816546883410156, 0.8155629139072847],
Evaluating
epoch:120, time: 303.152286(s), valid (NDCG@10: 0.6206, HR@10: 0.8482), test (NDCG@10: 0.5963, HR@10: 0.8212)
[120, 303.1522858142853, 0.6205655248155558, 0.8481788079470198, 0.5963410292432635, 0.8211920529801324],
Evaluating
epoch:160, time: 403.657261(s), valid (NDCG@10: 0.6253, HR@10: 0.8483), test (NDCG@10: 0.6012, HR@10: 0.8270)
[160, 403.6572606563568, 0.6252991945451356, 0.8483443708609272, 0.6012473779879826, 0.8269867549668874],
Evaluating
epoch:200, time: 504.119894(s), valid (NDCG@10: 0.6289, HR@10: 0.8513), test (NDCG@10: 0.6057, HR@10: 0.8263)
[200, 504.1198935508728, 0.6288640580756713, 0.8513245033112583, 0.6056949549806677, 0.8263245033112583],
Evaluating
epoch:240, time: 604.804832(s), valid (NDCG@10: 0.6301, HR@10: 0.8565), test (NDCG@10: 0.6073, HR@10: 0.8301)
[240, 604.8048324584961, 0.6301116216652327, 0.8564569536423841, 0.6072596057901297, 0.8301324503311258],
Evaluating
epoch:280, time: 705.349092(s), valid (NDCG@10: 0.6366, HR@10: 0.8550), test (NDCG@10: 0.6090, HR@10: 0.8263)
[280, 705.3490922451019, 0.6366332580744388, 0.8549668874172185, 0.6090333986363309, 0.8263245033112583],
Evaluating
epoch:320, time: 805.979243(s), valid (NDCG@10: 0.6348, HR@10: 0.8543), test (NDCG@10: 0.6088, HR@10: 0.8267)
[320, 805.9792425632477, 0.6347615606669887, 0.8543046357615894, 0.6087968866244418, 0.8266556291390729],
Evaluating
epoch:360, time: 906.779714(s), valid (NDCG@10: 0.6364, HR@10: 0.8568), test (NDCG@10: 0.6143, HR@10: 0.8320)
[360, 906.7797138690948, 0.636397097685905, 0.8567880794701986, 0.6143142950859999, 0.831953642384106],
Evaluating
epoch:400, time: 1007.266070(s), valid (NDCG@10: 0.6353, HR@10: 0.8545), test (NDCG@10: 0.6126, HR@10: 0.8291)
[400, 1007.2660701274872, 0.6353383949221155, 0.8544701986754967, 0.6125990979357626, 0.8291390728476821],
Evaluating
epoch:440, time: 1107.961937(s), valid (NDCG@10: 0.6399, HR@10: 0.8555), test (NDCG@10: 0.6105, HR@10: 0.8295)
[440, 1107.961936712265, 0.6399322633464104, 0.8554635761589404, 0.6104848796384197, 0.8294701986754967],
Evaluating
epoch:480, time: 1208.683558(s), valid (NDCG@10: 0.6388, HR@10: 0.8594), test (NDCG@10: 0.6151, HR@10: 0.8311)
[480, 1208.6835584640503, 0.6387547756549601, 0.8594370860927152, 0.6151349635029691, 0.8311258278145696],
Evaluating
epoch:520, time: 1309.680811(s), valid (NDCG@10: 0.6396, HR@10: 0.8576), test (NDCG@10: 0.6123, HR@10: 0.8310)
[520, 1309.6808106899261, 0.6396173966544374, 0.8576158940397351, 0.6123075345041217, 0.8309602649006622],
Evaluating
epoch:560, time: 1410.142197(s), valid (NDCG@10: 0.6380, HR@10: 0.8560), test (NDCG@10: 0.6153, HR@10: 0.8313)
[560, 1410.142196893692, 0.6379915590258319, 0.8559602649006622, 0.6152663517879415, 0.8312913907284768],
Evaluating
epoch:600, time: 1510.982587(s), valid (NDCG@10: 0.6393, HR@10: 0.8570), test (NDCG@10: 0.6128, HR@10: 0.8306)
[600, 1510.982587337494, 0.6393259863540617, 0.856953642384106, 0.6128201166269152, 0.8306291390728476],
Evaluating
epoch:640, time: 1611.494415(s), valid (NDCG@10: 0.6398, HR@10: 0.8571), test (NDCG@10: 0.6137, HR@10: 0.8298)
[640, 1611.4944150447845, 0.6398231699244264, 0.8571192052980132, 0.6136830856841093, 0.8298013245033112],
Evaluating
epoch:680, time: 1712.190229(s), valid (NDCG@10: 0.6379, HR@10: 0.8558), test (NDCG@10: 0.6149, HR@10: 0.8300)
[680, 1712.190229177475, 0.6378923559023827, 0.855794701986755, 0.6148580883228969, 0.8299668874172186],
Evaluating
epoch:720, time: 1812.757269(s), valid (NDCG@10: 0.6448, HR@10: 0.8614), test (NDCG@10: 0.6149, HR@10: 0.8323)
[720, 1812.7572691440582, 0.644776197303305, 0.8614238410596027, 0.6148512534696954, 0.8322847682119205],
Evaluating
epoch:760, time: 1913.551860(s), valid (NDCG@10: 0.6370, HR@10: 0.8518), test (NDCG@10: 0.6160, HR@10: 0.8326)
[760, 1913.5518596172333, 0.6370454233189742, 0.8518211920529801, 0.6159566341254368, 0.8326158940397351],
Evaluating
epoch:800, time: 2014.212717(s), valid (NDCG@10: 0.6394, HR@10: 0.8596), test (NDCG@10: 0.6159, HR@10: 0.8321)
[800, 2014.212717294693, 0.63944617451974, 0.8596026490066225, 0.6159223229994487, 0.8321192052980132],
Evaluating
epoch:840, time: 2114.863607(s), valid (NDCG@10: 0.6429, HR@10: 0.8571), test (NDCG@10: 0.6150, HR@10: 0.8301)
[840, 2114.8636071681976, 0.6429290242972694, 0.8571192052980132, 0.6149785461770102, 0.8301324503311258],
Evaluating
epoch:880, time: 2215.435398(s), valid (NDCG@10: 0.6423, HR@10: 0.8583), test (NDCG@10: 0.6159, HR@10: 0.8364)
[880, 2215.435398340225, 0.6423188871110471, 0.8582781456953642, 0.6159073032811595, 0.8364238410596027],
Evaluating
epoch:920, time: 2316.247768(s), valid (NDCG@10: 0.6412, HR@10: 0.8589), test (NDCG@10: 0.6148, HR@10: 0.8326)
[920, 2316.247768163681, 0.6412003134757985, 0.8589403973509934, 0.6148158267887569, 0.8326158940397351],
Evaluating
epoch:960, time: 2416.904327(s), valid (NDCG@10: 0.6407, HR@10: 0.8586), test (NDCG@10: 0.6167, HR@10: 0.8356)
[960, 2416.904327392578, 0.6406903247005166, 0.8586092715231788, 0.6167155587859248, 0.8355960264900663],
Evaluating
epoch:1000, time: 2517.390029(s), valid (NDCG@10: 0.6404, HR@10: 0.8581), test (NDCG@10: 0.6168, HR@10: 0.8344)
[1000, 2517.390029191971, 0.6404031997511705, 0.858112582781457, 0.6167823274338319, 0.8344370860927153],
Evaluating
epoch:1040, time: 2617.968476(s), valid (NDCG@10: 0.6423, HR@10: 0.8636), test (NDCG@10: 0.6162, HR@10: 0.8354)
[1040, 2617.968476295471, 0.6422680705545071, 0.8635761589403973, 0.6161703574708731, 0.8354304635761589],
Evaluating
epoch:1080, time: 2718.456212(s), valid (NDCG@10: 0.6424, HR@10: 0.8584), test (NDCG@10: 0.6193, HR@10: 0.8346)
[1080, 2718.456212043762, 0.6423571468869758, 0.8584437086092715, 0.6193203848297284, 0.8346026490066225],
Evaluating
epoch:1120, time: 2819.332399(s), valid (NDCG@10: 0.6415, HR@10: 0.8583), test (NDCG@10: 0.6147, HR@10: 0.8336)
[1120, 2819.332399368286, 0.6415329453787723, 0.8582781456953642, 0.6146543587408637, 0.8336092715231788],
Evaluating
epoch:1160, time: 2919.937249(s), valid (NDCG@10: 0.6407, HR@10: 0.8586), test (NDCG@10: 0.6211, HR@10: 0.8325)
[1160, 2919.937249183655, 0.640662871234467, 0.8586092715231788, 0.6211375473789946, 0.8324503311258278],
Evaluating
epoch:1200, time: 3020.459836(s), valid (NDCG@10: 0.6420, HR@10: 0.8599), test (NDCG@10: 0.6128, HR@10: 0.8318)
[1200, 3020.4598355293274, 0.6419863573252069, 0.8599337748344371, 0.6128100429269796, 0.8317880794701987],
Evaluating
epoch:1240, time: 3121.209459(s), valid (NDCG@10: 0.6419, HR@10: 0.8613), test (NDCG@10: 0.6188, HR@10: 0.8331)
[1240, 3121.209458589554, 0.6419339751471044, 0.8612582781456953, 0.6187871778456141, 0.833112582781457],
Evaluating
epoch:1280, time: 3221.819068(s), valid (NDCG@10: 0.6398, HR@10: 0.8579), test (NDCG@10: 0.6198, HR@10: 0.8339)
[1280, 3221.8190677165985, 0.639786549822494, 0.8579470198675496, 0.6197884372876513, 0.8339403973509933],
Evaluating
epoch:1320, time: 3322.085048(s), valid (NDCG@10: 0.6395, HR@10: 0.8583), test (NDCG@10: 0.6150, HR@10: 0.8326)
[1320, 3322.0850481987, 0.6394597308493283, 0.8582781456953642, 0.6150054315917539, 0.8326158940397351],
Evaluating
epoch:1360, time: 3422.938881(s), valid (NDCG@10: 0.6423, HR@10: 0.8594), test (NDCG@10: 0.6175, HR@10: 0.8353)
[1360, 3422.93888092041, 0.6422511510266203, 0.8594370860927152, 0.6175057339495288, 0.8352649006622517],
Evaluating
epoch:1400, time: 3523.581020(s), valid (NDCG@10: 0.6448, HR@10: 0.8609), test (NDCG@10: 0.6147, HR@10: 0.8305)
[1400, 3523.581019639969, 0.6447869413457936, 0.8609271523178808, 0.6147456540284841, 0.8304635761589404],
Evaluating
epoch:1440, time: 3624.314080(s), valid (NDCG@10: 0.6415, HR@10: 0.8599), test (NDCG@10: 0.6165, HR@10: 0.8328)
[1440, 3624.3140802383423, 0.6414871020609819, 0.8599337748344371, 0.6164834165039441, 0.8327814569536424],
Evaluating
epoch:1480, time: 3725.111492(s), valid (NDCG@10: 0.6438, HR@10: 0.8593), test (NDCG@10: 0.6185, HR@10: 0.8334)
[1480, 3725.1114916801453, 0.6438210817015211, 0.859271523178808, 0.6185199721153086, 0.8334437086092715],
Evaluating
epoch:1520, time: 3825.590101(s), valid (NDCG@10: 0.6421, HR@10: 0.8573), test (NDCG@10: 0.6178, HR@10: 0.8311)
[1520, 3825.590101480484, 0.6421288972036839, 0.8572847682119206, 0.6178446091953103, 0.8311258278145696],
Evaluating
epoch:1560, time: 3926.292320(s), valid (NDCG@10: 0.6429, HR@10: 0.8568), test (NDCG@10: 0.6187, HR@10: 0.8363)
[1560, 3926.292319536209, 0.6429029112744884, 0.8567880794701986, 0.618673304016158, 0.8362582781456953],
Evaluating
epoch:1600, time: 4026.689263(s), valid (NDCG@10: 0.6448, HR@10: 0.8596), test (NDCG@10: 0.6183, HR@10: 0.8387)
[1600, 4026.689262866974, 0.6448267822066456, 0.8596026490066225, 0.6182514475975667, 0.8387417218543046],
Evaluating
epoch:1640, time: 4126.883899(s), valid (NDCG@10: 0.6440, HR@10: 0.8576), test (NDCG@10: 0.6196, HR@10: 0.8344)
[1640, 4126.883898973465, 0.6439904743602651, 0.8576158940397351, 0.6195511803504002, 0.8344370860927153],
Evaluating
epoch:1680, time: 4227.418514(s), valid (NDCG@10: 0.6420, HR@10: 0.8596), test (NDCG@10: 0.6190, HR@10: 0.8351)
[1680, 4227.418514490128, 0.6419804192357096, 0.8596026490066225, 0.6189560745461439, 0.8350993377483443],
Evaluating
epoch:1720, time: 4327.932660(s), valid (NDCG@10: 0.6413, HR@10: 0.8571), test (NDCG@10: 0.6174, HR@10: 0.8348)
[1720, 4327.932660341263, 0.6413071044001681, 0.8571192052980132, 0.6174263868731278, 0.8347682119205299],
Evaluating
epoch:1760, time: 4428.397719(s), valid (NDCG@10: 0.6438, HR@10: 0.8596), test (NDCG@10: 0.6168, HR@10: 0.8343)
[1760, 4428.397718667984, 0.6437587995000251, 0.8596026490066225, 0.6168131016169549, 0.8342715231788079],
Evaluating
epoch:1800, time: 4529.093910(s), valid (NDCG@10: 0.6433, HR@10: 0.8568), test (NDCG@10: 0.6157, HR@10: 0.8305)
[1800, 4529.093909502029, 0.6432825313418069, 0.8567880794701986, 0.6156681594926393, 0.8304635761589404],
Evaluating
epoch:1840, time: 4629.714136(s), valid (NDCG@10: 0.6406, HR@10: 0.8588), test (NDCG@10: 0.6163, HR@10: 0.8318)
[1840, 4629.714135885239, 0.6406354220248449, 0.8587748344370861, 0.6163103547691882, 0.8317880794701987],
Evaluating
epoch:1880, time: 4730.448176(s), valid (NDCG@10: 0.6437, HR@10: 0.8581), test (NDCG@10: 0.6187, HR@10: 0.8343)
[1880, 4730.448175907135, 0.6437474166438724, 0.858112582781457, 0.6186660077139081, 0.8342715231788079],
Evaluating
epoch:1920, time: 4831.099910(s), valid (NDCG@10: 0.6400, HR@10: 0.8588), test (NDCG@10: 0.6182, HR@10: 0.8343)
[1920, 4831.099910259247, 0.6399731858982537, 0.8587748344370861, 0.6181855973765649, 0.8342715231788079],
Evaluating
epoch:1960, time: 4931.497815(s), valid (NDCG@10: 0.6431, HR@10: 0.8584), test (NDCG@10: 0.6200, HR@10: 0.8364)
[1960, 4931.4978148937225, 0.643093871145905, 0.8584437086092715, 0.619957180286527, 0.8364238410596027],
Evaluating
epoch:2000, time: 5032.101698(s), valid (NDCG@10: 0.6402, HR@10: 0.8556), test (NDCG@10: 0.6143, HR@10: 0.8308)
[2000, 5032.1016981601715, 0.6402315084151865, 0.8556291390728477, 0.6143302739276769, 0.830794701986755],
WARNING:tensorflow:From main.py:110: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

Model saved in path: ml1m_model
Done